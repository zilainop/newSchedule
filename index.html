<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Channel Progress Tracker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-color: #0f0f0f;
            --card-bg: #1f1f1f;
            --text-color: #f1f1f1;
            --text-secondary: #aaa;
            --primary-color: #ff0000;
            --primary-hover: #cc0000;
            --success-color: #4CAF50;
            --danger-color: #ff4444;
            --border-color: #333;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
            --transition: all 0.3s ease;
        }

        .light-mode {
            --bg-color: #f5f5f5;
            --card-bg: #ffffff;
            --text-color: #333333;
            --text-secondary: #666;
            --primary-color: #ff0000;
            --primary-hover: #cc0000;
            --success-color: #2e7d32;
            --danger-color: #d32f2f;
            --border-color: #ddd;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
            min-height: 100vh;
        }

        .container {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 2px solid var(--primary-color);
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        h1 {
            color: var(--primary-color);
            font-size: 2.8rem;
            margin-bottom: 5px;
        }

        .tagline {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .header-controls {
            display: flex;
            gap: 10px;
        }

        .theme-toggle, .settings-btn {
            background-color: var(--card-bg);
            border: 2px solid var(--border-color);
            color: var(--text-color);
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }

        .theme-toggle:hover, .settings-btn:hover {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .progress-container {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .progress-title {
            font-size: 1.5rem;
            color: var(--text-color);
        }

        .progress-percentage {
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .progress-bar {
            height: 25px;
            background-color: var(--border-color);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, var(--primary-color), #ff6b6b);
            width: 0%;
            transition: width 0.5s ease-in-out;
            border-radius: 12px;
        }

        .progress-stats {
            display: flex;
            justify-content: space-between;
            color: var(--text-secondary);
            font-size: 0.9rem;
            flex-wrap: wrap;
            gap: 10px;
        }

        .channels-container {
            background-color: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .channels-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .channels-title {
            font-size: 1.5rem;
            color: var(--text-color);
        }

        .add-channel-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }

        .add-channel-btn:hover {
            background-color: var(--primary-hover);
        }

        .channels-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .channel-item {
            background-color: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            transition: var(--transition);
        }

        .channel-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .channel-item.completed {
            border-color: var(--success-color);
            background-color: rgba(76, 175, 80, 0.05);
        }

        .channel-main-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .channel-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
        }

        .channel-number {
            background-color: var(--primary-color);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .channel-details {
            flex: 1;
        }

        .channel-name {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .channel-videos {
            color: var(--text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .channel-actions {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .videos-count {
            background-color: var(--border-color);
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: var(--primary-color);
            min-width: 90px;
            text-align: center;
        }

        .channel-main-actions {
            display: flex;
            gap: 10px;
        }

        .complete-btn {
            background-color: transparent;
            border: 2px solid var(--success-color);
            color: var(--success-color);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
        }

        .complete-btn:hover {
            background-color: var(--success-color);
            color: white;
        }

        .complete-btn.completed {
            background-color: var(--success-color);
            color: white;
        }

        .delete-btn {
            background-color: transparent;
            border: 2px solid var(--danger-color);
            color: var(--danger-color);
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
        }

        .delete-btn:hover {
            background-color: var(--danger-color);
            color: white;
        }

        .video-progress-container {
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            margin-top: 10px;
        }

        .video-progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .video-progress-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-color);
        }

        .video-progress-stats {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .video-marks {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .video-mark {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .video-mark:hover {
            transform: scale(1.1);
        }

        .video-mark.completed {
            background-color: var(--success-color);
            color: white;
        }

        .video-mark.active {
            border-color: var(--primary-color);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-content {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.8rem;
            color: var(--text-color);
        }

        .close-btn {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 1.8rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .close-btn:hover {
            color: var(--text-color);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-color);
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            background-color: var(--card-bg);
            color: var(--text-color);
            font-size: 1rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .videos-input-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .videos-input {
            flex: 1;
            max-width: 200px;
        }

        .videos-hint {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 25px;
        }

        .cancel-btn {
            background-color: var(--border-color);
            color: var(--text-color);
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
        }

        .cancel-btn:hover {
            background-color: var(--text-secondary);
        }

        .save-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
        }

        .save-btn:hover {
            background-color: var(--primary-hover);
        }

        footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 20px;
            border-top: 1px solid var(--border-color);
            flex-wrap: wrap;
            gap: 15px;
        }

        .footer-info {
            flex: 1;
        }

        .refresh-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }

        .refresh-btn:hover {
            background-color: var(--primary-hover);
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--border-color);
        }

        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        /* Color options for settings */
        .color-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 10px;
        }

        .color-option {
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            border: 2px solid var(--border-color);
            transition: var(--transition);
        }

        .color-option:hover {
            transform: scale(1.05);
        }

        .color-option.selected {
            border-color: var(--text-color);
            box-shadow: 0 0 0 2px var(--primary-color);
        }

        .color-preview {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 0 auto 10px;
        }

        .color-name {
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* Specific color options */
        .color-red { background-color: #ff0000; }
        .color-blue { background-color: #4285f4; }
        .color-green { background-color: #34A853; }
        .color-purple { background-color: #9c27b0; }
        .color-orange { background-color: #ff9800; }
        .color-teal { background-color: #009688; }

        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .channel-main-info {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .channel-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .progress-percentage {
                font-size: 1.8rem;
            }
            
            .modal-content {
                padding: 20px;
            }
            
            footer {
                flex-direction: column;
                text-align: center;
            }
            
            .header-controls {
                flex-direction: column;
                width: 100%;
                max-width: 200px;
            }
            
            .color-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body class="dark-mode">
    <div class="container">
        <header>
            <div class="header-left">
                <div>
                    <h1><i class="fab fa-youtube"></i> Channel Progress Tracker</h1>
                    <p class="tagline">Track your YouTube video creation progress across multiple channels</p>
                </div>
            </div>
            <div class="header-controls">
                <button class="settings-btn" id="settings-btn">
                    <i class="fas fa-cog"></i> Settings
                </button>
                <button class="theme-toggle" id="theme-toggle">
                    <i class="fas fa-sun"></i> Light Mode
                </button>
            </div>
        </header>
        
        <div class="progress-container">
            <div class="progress-header">
                <h2 class="progress-title">Overall Progress</h2>
                <div class="progress-percentage">0%</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
            <div class="progress-stats">
                <div class="channels-count">Total Channels: <span id="total-channels">0</span></div>
                <div class="completed-count">Completed: <span id="completed-channels">0</span></div>
                <div class="videos-remaining">Videos Completed: <span id="videos-completed">0</span> / <span id="total-videos">0</span></div>
            </div>
        </div>
        
        <div class="channels-container">
            <div class="channels-header">
                <h2 class="channels-title">Your Channels</h2>
                <button class="add-channel-btn" id="add-channel-btn">
                    <i class="fas fa-plus-circle"></i> Add Channel
                </button>
            </div>
            
            <div class="channels-list" id="channels-list">
                <!-- Channels will be dynamically added here -->
                <div class="empty-state" id="empty-state">
                    <i class="fas fa-list-alt"></i>
                    <h3>No channels added yet</h3>
                    <p>Click the "Add Channel" button to start tracking your YouTube channels</p>
                </div>
            </div>
        </div>
        
        <footer>
            <div class="footer-info">
                <p>Your data is stored locally on this device | Made with <i class="fas fa-heart" style="color: var(--primary-color);"></i> for YouTube creators</p>
            </div>
            <button class="refresh-btn" id="refresh-btn">
                <i class="fas fa-redo"></i> Reset Progress
            </button>
        </footer>
    </div>
    
    <!-- Add Channel Modal -->
    <div class="modal" id="channel-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Add New Channel</h2>
                <button class="close-btn" id="close-modal">&times;</button>
            </div>
            <form id="channel-form">
                <div class="form-group">
                    <label for="channel-name" class="form-label">Channel Name</label>
                    <input type="text" id="channel-name" class="form-input" placeholder="Enter channel name" required>
                </div>
                <div class="form-group">
                    <label for="videos-count" class="form-label">Number of Videos to Create</label>
                    <div class="videos-input-container">
                        <input type="number" id="videos-count" class="form-input videos-input" min="1" max="50" value="1" required>
                        <div class="videos-hint">Enter any number from 1 to 50</div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button type="button" class="cancel-btn" id="cancel-modal">Cancel</button>
                    <button type="submit" class="save-btn" id="save-channel">Add Channel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settings-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Settings</h2>
                <button class="close-btn" id="close-settings-modal">&times;</button>
            </div>
            <div class="form-group">
                <label class="form-label">Primary Color Theme</label>
                <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.9rem;">
                    Choose a color for progress indicators, buttons, and headings
                </p>
                <div class="color-options">
                    <div class="color-option" data-color="#ff0000" data-color-name="red">
                        <div class="color-preview color-red"></div>
                        <div class="color-name">Red</div>
                    </div>
                    <div class="color-option" data-color="#4285f4" data-color-name="blue">
                        <div class="color-preview color-blue"></div>
                        <div class="color-name">Blue</div>
                    </div>
                    <div class="color-option" data-color="#34A853" data-color-name="green">
                        <div class="color-preview color-green"></div>
                        <div class="color-name">Green</div>
                    </div>
                    <div class="color-option" data-color="#9c27b0" data-color-name="purple">
                        <div class="color-preview color-purple"></div>
                        <div class="color-name">Purple</div>
                    </div>
                    <div class="color-option" data-color="#ff9800" data-color-name="orange">
                        <div class="color-preview color-orange"></div>
                        <div class="color-name">Orange</div>
                    </div>
                    <div class="color-option" data-color="#009688" data-color-name="teal">
                        <div class="color-preview color-teal"></div>
                        <div class="color-name">Teal</div>
                    </div>
                </div>
            </div>
            <div class="modal-actions">
                <button type="button" class="cancel-btn" id="cancel-settings">Cancel</button>
                <button type="button" class="save-btn" id="save-settings">Save Changes</button>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const addChannelBtn = document.getElementById('add-channel-btn');
        const channelModal = document.getElementById('channel-modal');
        const closeModalBtn = document.getElementById('close-modal');
        const cancelModalBtn = document.getElementById('cancel-modal');
        const channelForm = document.getElementById('channel-form');
        const channelsList = document.getElementById('channels-list');
        const emptyState = document.getElementById('empty-state');
        const themeToggle = document.getElementById('theme-toggle');
        const refreshBtn = document.getElementById('refresh-btn');
        const modalTitle = document.getElementById('modal-title');
        const saveChannelBtn = document.getElementById('save-channel');
        
        // Settings modal elements
        const settingsBtn = document.getElementById('settings-btn');
        const settingsModal = document.getElementById('settings-modal');
        const closeSettingsBtn = document.getElementById('close-settings-modal');
        const cancelSettingsBtn = document.getElementById('cancel-settings');
        const saveSettingsBtn = document.getElementById('save-settings');
        const colorOptions = document.querySelectorAll('.color-option');
        
        // Progress elements
        const progressPercentage = document.querySelector('.progress-percentage');
        const progressFill = document.querySelector('.progress-fill');
        const totalChannelsEl = document.getElementById('total-channels');
        const completedChannelsEl = document.getElementById('completed-channels');
        const videosCompletedEl = document.getElementById('videos-completed');
        const totalVideosEl = document.getElementById('total-videos');
        
        // State
        let channels = [];
        let editingIndex = -1; // -1 means adding new channel, otherwise editing existing
        let isLightMode = false;
        let selectedColor = '#ff0000'; // Default color
        
        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            loadChannels();
            loadTheme();
            loadColor();
            updateUI();
        });
        
        // Theme toggle
        themeToggle.addEventListener('click', () => {
            isLightMode = !isLightMode;
            if (isLightMode) {
                document.body.classList.add('light-mode');
                document.body.classList.remove('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
            } else {
                document.body.classList.remove('light-mode');
                document.body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
            }
            saveTheme();
        });
        
        // Settings button
        settingsBtn.addEventListener('click', () => {
            settingsModal.style.display = 'flex';
        });
        
        closeSettingsBtn.addEventListener('click', () => {
            settingsModal.style.display = 'none';
        });
        
        cancelSettingsBtn.addEventListener('click', () => {
            settingsModal.style.display = 'none';
        });
        
        // Color selection
        colorOptions.forEach(option => {
            option.addEventListener('click', () => {
                // Remove selected class from all options
                colorOptions.forEach(opt => opt.classList.remove('selected'));
                // Add selected class to clicked option
                option.classList.add('selected');
                selectedColor = option.dataset.color;
            });
        });
        
        // Save settings
        saveSettingsBtn.addEventListener('click', () => {
            document.documentElement.style.setProperty('--primary-color', selectedColor);
            // Calculate a darker version for hover
            const hoverColor = adjustColor(selectedColor, -30);
            document.documentElement.style.setProperty('--primary-hover', hoverColor);
            saveColor();
            settingsModal.style.display = 'none';
            showNotification('Color theme updated!');
            updateUI();
        });
        
        // Modal handlers
        addChannelBtn.addEventListener('click', () => {
            editingIndex = -1;
            document.getElementById('channel-name').value = '';
            document.getElementById('videos-count').value = '1';
            modalTitle.textContent = 'Add New Channel';
            saveChannelBtn.textContent = 'Add Channel';
            channelModal.style.display = 'flex';
        });
        
        closeModalBtn.addEventListener('click', () => {
            channelModal.style.display = 'none';
        });
        
        cancelModalBtn.addEventListener('click', () => {
            channelModal.style.display = 'none';
        });
        
        // Form submission
        channelForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const channelName = document.getElementById('channel-name').value;
            let videosCount = parseInt(document.getElementById('videos-count').value);
            
            // Validate videos count
            if (videosCount < 1) videosCount = 1;
            if (videosCount > 50) videosCount = 50;
            
            if (editingIndex === -1) {
                // Add new channel
                channels.push({
                    id: Date.now(),
                    name: channelName,
                    videosCount: videosCount,
                    completed: false,
                    completedVideos: 0,
                    position: channels.length + 1,
                    videoProgress: Array(videosCount).fill(false)
                });
            } else {
                // Edit existing channel
                const oldVideoCount = channels[editingIndex].videosCount;
                channels[editingIndex].name = channelName;
                
                // Handle video progress array when changing video count
                if (videosCount !== oldVideoCount) {
                    const newVideoProgress = [];
                    for (let i = 0; i < videosCount; i++) {
                        newVideoProgress.push(i < oldVideoCount ? channels[editingIndex].videoProgress[i] : false);
                    }
                    channels[editingIndex].videoProgress = newVideoProgress;
                    channels[editingIndex].videosCount = videosCount;
                    
                    // Recalculate completed videos
                    channels[editingIndex].completedVideos = newVideoProgress.filter(v => v).length;
                    channels[editingIndex].completed = channels[editingIndex].completedVideos === videosCount;
                }
            }
            
            saveChannels();
            updateUI();
            channelModal.style.display = 'none';
        });
        
        // Refresh/Reset button - FIXED
        refreshBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to reset all video progress to 0%? This will keep all your channels but mark all videos as incomplete.')) {
                resetAllProgress();
                showNotification('All progress has been reset to 0%');
            }
        });
        
        // Functions
        function resetAllProgress() {
            channels.forEach(channel => {
                channel.videoProgress = Array(channel.videosCount).fill(false);
                channel.completedVideos = 0;
                channel.completed = false;
            });
            saveChannels();
            updateUI();
        }
        
        function updateUI() {
            // Hide/show empty state
            if (channels.length === 0) {
                emptyState.style.display = 'block';
            } else {
                emptyState.style.display = 'none';
            }
            
            // Clear channels list
            channelsList.innerHTML = '';
            
            // Calculate progress
            const totalChannels = channels.length;
            const completedChannels = channels.filter(ch => ch.completed).length;
            
            // Calculate video progress
            let totalVideos = 0;
            let completedVideos = 0;
            
            channels.forEach(channel => {
                totalVideos += channel.videosCount;
                completedVideos += channel.completedVideos;
            });
            
            const percentage = totalVideos > 0 ? Math.round((completedVideos / totalVideos) * 100) : 0;
            
            // Update progress UI
            progressPercentage.textContent = `${percentage}%`;
            progressFill.style.width = `${percentage}%`;
            totalChannelsEl.textContent = totalChannels;
            completedChannelsEl.textContent = completedChannels;
            videosCompletedEl.textContent = completedVideos;
            totalVideosEl.textContent = totalVideos;
            
            // Render channels
            channels.forEach((channel, index) => {
                const channelItem = document.createElement('div');
                channelItem.className = `channel-item ${channel.completed ? 'completed' : ''}`;
                
                // Create video marks HTML
                let videoMarksHTML = '';
                for (let i = 0; i < channel.videosCount; i++) {
                    const isCompleted = channel.videoProgress[i] || false;
                    videoMarksHTML += `
                        <div class="video-mark ${isCompleted ? 'completed' : ''} ${i === channel.completedVideos ? 'active' : ''}" 
                             data-channel-id="${channel.id}" data-video-index="${i}">
                            ${i + 1}
                        </div>
                    `;
                }
                
                channelItem.innerHTML = `
                    <div class="channel-main-info">
                        <div class="channel-info">
                            <div class="channel-number">${index + 1}</div>
                            <div class="channel-details">
                                <div class="channel-name">${channel.name}</div>
                                <div class="channel-videos">
                                    <i class="fas fa-video"></i>
                                    <span>${channel.videosCount} video${channel.videosCount !== 1 ? 's' : ''} to create</span>
                                </div>
                            </div>
                        </div>
                        <div class="channel-actions">
                            <div class="videos-count">${channel.completedVideos}/${channel.videosCount} done</div>
                            <div class="channel-main-actions">
                                <button class="complete-btn ${channel.completed ? 'completed' : ''}" data-id="${channel.id}">
                                    ${channel.completed ? '<i class="fas fa-check"></i> Completed' : 'Mark All Complete'}
                                </button>
                                <button class="delete-btn" data-id="${channel.id}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="video-progress-container">
                        <div class="video-progress-header">
                            <div class="video-progress-title">Video Progress</div>
                            <div class="video-progress-stats">
                                ${channel.completedVideos} of ${channel.videosCount} videos completed
                                ${channel.completedVideos > 0 ? `(${Math.round((channel.completedVideos / channel.videosCount) * 100)}%)` : ''}
                            </div>
                        </div>
                        <div class="video-marks">
                            ${videoMarksHTML}
                        </div>
                    </div>
                `;
                
                channelsList.appendChild(channelItem);
            });
            
            // Add event listeners to buttons
            document.querySelectorAll('.complete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.dataset.id);
                    toggleChannelComplete(id);
                });
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.dataset.id);
                    deleteChannel(id);
                });
            });
            
            // Add event listeners to video marks
            document.querySelectorAll('.video-mark').forEach(mark => {
                mark.addEventListener('click', function() {
                    const channelId = parseInt(this.dataset.channelId);
                    const videoIndex = parseInt(this.dataset.videoIndex);
                    toggleVideoComplete(channelId, videoIndex);
                });
            });
        }
        
        function toggleVideoComplete(channelId, videoIndex) {
            const channelIndex = channels.findIndex(ch => ch.id === channelId);
            if (channelIndex !== -1) {
                // Toggle the specific video
                channels[channelIndex].videoProgress[videoIndex] = !channels[channelIndex].videoProgress[videoIndex];
                
                // Recalculate completed videos for this channel
                channels[channelIndex].completedVideos = channels[channelIndex].videoProgress.filter(v => v).length;
                
                // Update channel completion status
                channels[channelIndex].completed = channels[channelIndex].completedVideos === channels[channelIndex].videosCount;
                
                saveChannels();
                updateUI();
            }
        }
        
        function toggleChannelComplete(id) {
            const channelIndex = channels.findIndex(ch => ch.id === id);
            if (channelIndex !== -1) {
                // Toggle all videos for this channel
                const allComplete = channels[channelIndex].completed;
                
                if (allComplete) {
                    // Mark all as incomplete
                    channels[channelIndex].videoProgress = channels[channelIndex].videoProgress.map(() => false);
                    channels[channelIndex].completedVideos = 0;
                } else {
                    // Mark all as complete
                    channels[channelIndex].videoProgress = channels[channelIndex].videoProgress.map(() => true);
                    channels[channelIndex].completedVideos = channels[channelIndex].videosCount;
                }
                
                channels[channelIndex].completed = !allComplete;
                saveChannels();
                updateUI();
            }
        }
        
        function deleteChannel(id) {
            if (confirm('Are you sure you want to delete this channel?')) {
                channels = channels.filter(ch => ch.id !== id);
                // Reorder positions
                channels.forEach((ch, index) => {
                    ch.position = index + 1;
                });
                saveChannels();
                updateUI();
                showNotification('Channel deleted successfully');
            }
        }
        
        // Color utility function
        function adjustColor(color, amount) {
            // Remove the hash if present
            color = color.replace('#', '');
            
            // Parse the color components
            let r = parseInt(color.substr(0, 2), 16);
            let g = parseInt(color.substr(2, 2), 16);
            let b = parseInt(color.substr(4, 2), 16);
            
            // Adjust the color
            r = Math.max(0, Math.min(255, r + amount));
            g = Math.max(0, Math.min(255, g + amount));
            b = Math.max(0, Math.min(255, b + amount));
            
            // Convert back to hex
            const newColor = `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1)}`;
            return newColor;
        }
        
        function showNotification(message) {
            // Create notification element
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background-color: var(--success-color);
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
                z-index: 10000;
                font-weight: bold;
                animation: slideIn 0.3s ease, fadeOut 0.3s ease 2s forwards;
            `;
            
            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Remove notification after animation
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
                if (style.parentNode) {
                    style.parentNode.removeChild(style);
                }
            }, 2300);
        }
        
        // Local storage functions
        function saveChannels() {
            localStorage.setItem('youtubeChannels', JSON.stringify(channels));
        }
        
        function loadChannels() {
            const savedChannels = localStorage.getItem('youtubeChannels');
            if (savedChannels) {
                channels = JSON.parse(savedChannels);
            }
        }
        
        function saveTheme() {
            localStorage.setItem('youtubeTrackerTheme', isLightMode ? 'light' : 'dark');
        }
        
        function loadTheme() {
            const savedTheme = localStorage.getItem('youtubeTrackerTheme');
            if (savedTheme) {
                isLightMode = savedTheme === 'light';
                if (isLightMode) {
                    document.body.classList.add('light-mode');
                    document.body.classList.remove('dark-mode');
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i> Dark Mode';
                } else {
                    document.body.classList.remove('light-mode');
                    document.body.classList.add('dark-mode');
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
                }
            }
        }
        
        function saveColor() {
            localStorage.setItem('youtubeTrackerColor', selectedColor);
        }
        
        function loadColor() {
            const savedColor = localStorage.getItem('youtubeTrackerColor');
            if (savedColor) {
                selectedColor = savedColor;
                document.documentElement.style.setProperty('--primary-color', selectedColor);
                const hoverColor = adjustColor(selectedColor, -30);
                document.documentElement.style.setProperty('--primary-hover', hoverColor);
                
                // Update selected color in settings modal
                colorOptions.forEach(option => {
                    if (option.dataset.color === selectedColor) {
                        option.classList.add('selected');
                    }
                });
            }
        }
    </script>
</body>
</html>